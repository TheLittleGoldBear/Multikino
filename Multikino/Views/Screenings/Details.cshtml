@model Multikino.Models.View.PurchaseTicketViewModel
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@{
    ViewData["Title"] = "Kup bilet";
}

<h1>Kup bilet</h1>

<div class="card mb-4">
    <div class="card-body">
        <h4 class="card-title">@Model.MovieTitle</h4>
        <p class="mb-1"><strong>Sala:</strong> @Model.HallName</p>
        <p class="mb-1"><strong>Start:</strong> @Model.StartTime.ToLocalTime().ToString("f")</p>
        <p class="mb-1"><strong>Cena:</strong> @Model.Price.ToString("C")</p>
    </div>
</div>

@if (!User.Identity.IsAuthenticated)
{
    <div class="alert alert-warning">
        Aby kupić bilet, <a asp-controller="Account" asp-action="Login">zaloguj się</a>.
    </div>
}

<!-- Formularz zakupu biletu -->
<form asp-action="Details" method="post" class="card p-3">
    @Html.AntiForgeryToken()

    <!-- Ukryte pola dla walidacji -->
    <input type="hidden" asp-for="ScreeningId" />
    <input type="hidden" asp-for="MovieTitle" />
    <input type="hidden" asp-for="HallName" />
    <input type="hidden" asp-for="StartTime" />
    <input type="hidden" asp-for="Price" />

    <!-- Wyświetlanie błędów walidacji -->
    <div asp-validation-summary="All" class="text-danger mb-2"></div>

    <button type="submit" class="btn btn-success" @(User.Identity.IsAuthenticated ? "" : "disabled")>
        Kup bilet
    </button>

    <a asp-action="Index" asp-controller="Screenings" class="btn btn-secondary ms-2">Powrót</a>
</form>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
